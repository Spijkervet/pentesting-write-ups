# HackTheBox | Hawk Write-up

*October 13, 2018*

Author: Jane Wilde (wilde)



[TOC]

| Severity Level   | **<span style="color: red"></span>** |
| ---------------- | ------------------------------------ |
| **Access level** | **Method**                           |
| User             |                                      |
| Root             |                                      |

<div style="page-break-after: always;"></div>

#Recap



<div style="page-break-after: always;"></div>

# Service Enumeration

##nmap

A quick `nmap` scan gives:

```
nmap -sC -sV -oA hawk 10.10.10.102
```

```
Starting Nmap 7.70 ( https://nmap.org ) at 2018-10-15 04:06 EDT
Stats: 0:00:03 elapsed; 0 hosts completed (1 up), 1 undergoing SYN Stealth Scan
SYN Stealth Scan Timing: About 74.33% done; ETC: 04:06 (0:00:01 remaining)
Nmap scan report for 10.10.10.102
Host is up (0.27s latency).
Not shown: 996 closed ports
PORT     STATE SERVICE VERSION
21/tcp   open  ftp     vsftpd 3.0.3
| ftp-anon: Anonymous FTP login allowed (FTP code 230)
|_drwxr-xr-x    2 ftp      ftp          4096 Jun 16 22:21 messages
| ftp-syst:
|   STAT:
| FTP server status:
|      Connected to ::ffff:10.10.13.9
|      Logged in as ftp
|      TYPE: ASCII
|      No session bandwidth limit
|      Session timeout in seconds is 300
|      Control connection is plain text
|      Data connections will be plain text
|      At session startup, client count was 2
|      vsFTPd 3.0.3 - secure, fast, stable
|_End of status
22/tcp   open  ssh     OpenSSH 7.6p1 Ubuntu 4 (Ubuntu Linux; protocol 2.0)
| ssh-hostkey:
|   2048 e4:0c:cb:c5:a5:91:78:ea:54:96:af:4d:03:e4:fc:88 (RSA)
|   256 95:cb:f8:c7:35:5e:af:a9:44:8b:17:59:4d:db:5a:df (ECDSA)
|_  256 4a:0b:2e:f7:1d:99:bc:c7:d3:0b:91:53:b9:3b:e2:79 (ED25519)
80/tcp   open  http    Apache httpd 2.4.29 ((Ubuntu))
|_http-generator: Drupal 7 (http://drupal.org)
| http-robots.txt: 36 disallowed entries (15 shown)
| /includes/ /misc/ /modules/ /profiles/ /scripts/
| /themes/ /CHANGELOG.txt /cron.php /INSTALL.mysql.txt
| /INSTALL.pgsql.txt /INSTALL.sqlite.txt /install.php /INSTALL.txt
|_/LICENSE.txt /MAINTAINERS.txt
|_http-server-header: Apache/2.4.29 (Ubuntu)
|_http-title: Welcome to 192.168.56.103 | 192.168.56.103
8082/tcp open  http    H2 database http console
|_http-title: H2 Console
Service Info: OSs: Unix, Linux; CPE: cpe:/o:linux:linux_kernel

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 48.00 seconds
```

An exposed ftp, ssh and http service. Another http service lives on port 8082. First, we try out an anonymous ftp server login:

```
ftp 10.10.10.102
```

```
Connected to 10.10.10.102.
220 (vsFTPd 3.0.3)
Name (10.10.10.102:root): anonymous
230 Login successful.
Remote system type is UNIX.
Using binary mode to transfer files.
ftp>
```

An error "500 Illegal PORT command" is displayed. The error is a response sent from the FTP server when a client sends the PORT command but the server is configured for **Passive Mode** and is expecting the **PASV** command.

```
ftp> ls
500 Illegal PORT command.
ftp> passive
Passive mode on.
ftp> ls
227 Entering Passive Mode (10,10,10,102,165,195)
150 Here comes the directory listing.
drwxr-xr-x    2 ftp      ftp          4096 Jun 16 22:21 messages
226 Directory send OK.
```

Some enumeration on the FTP server yields a `.drupal.txt.enc` file:

```
ftp> ls -a
227 Entering Passive Mode (10,10,10,102,183,15)
150 Here comes the directory listing.
drwxr-xr-x    2 ftp      ftp          4096 Jun 16 22:21 .
drwxr-xr-x    3 ftp      ftp          4096 Jun 16 22:14 ..
-rw-r--r--    1 ftp      ftp           240 Jun 16 22:21 .drupal.txt.enc
226 Directory send OK.
ftp> get .drupal.txt.enc -
remote: .drupal.txt.enc
227 Entering Passive Mode (10,10,10,102,182,147)
150 Opening BINARY mode data connection for .drupal.txt.enc (240 bytes).
U2FsdGVkX19rWSAG1JNpLTawAmzz/ckaN1oZFZewtIM+e84km3Csja3GADUg2jJb
CmSdwTtr/IIShvTbUd0yQxfe9OuoMxxfNIUN/YPHx+vVw/6eOD+Cc1ftaiNUEiQz
QUf9FyxmCb2fuFoOXGphAMo+Pkc2ChXgLsj4RfgX+P7DkFa8w1ZA9Yj7kR+tyZfy
t4M0qvmWvMhAj3fuuKCCeFoXpYBOacGvUHRGywb4YCk=
226 Transfer complete.
240 bytes received in 0.00 secs (435.6412 kB/s)
```

Decoding the file:

```
Salted__kY ‘ìi-6l7Z>{$pÔøΩ5 2[
d;kQ2C3_4
8?sWj#T$3AG,f	Z\jaÔøΩ>>G6
.E√êVV@…ó4@wÓ∏†xZNiPtF`)
```

Requesting `robots.txt` gives us an XMLRPC path:

```
curl http://10.10.10.102/robots.txt
```

```
#
# robots.txt
#
Disallow: /xmlrpc.php
```

Making a POST request with a known XMLRPC exploit:

```
<?xml version="1.0"?>
<methodCall>
<methodName>system.listMethods</methodName>
<params>
<param>
</param>
</params>
</methodCall>
```

Yields no interesting results.



# Penetration

##User access





##Root access




